##### 三大要素：内存数据库、高效的数据结构、IO多路复用



##### 一.  内存数据库

1.1 内存是CPU与磁盘间高速缓存介质；基于内存的操作，确实比其他（如mysql）基于磁盘的数据库操作要快，这是毋庸置疑的

1.2  以人为例，大脑比作内存，课本比作磁盘，大脑记住的内容可以迅速回答出来，没记住的内容就要翻书温习，显然，翻书查找再回答，速度就慢了；大脑能记住的内容有限，事多了还是要记在本子上的，redis为防止宕机带来的数据丢失，提供了AOF和RDB的数据保存方式（下篇记录再提）

##### 二. 高效的数据结构

2.1 由键找值：键值对是通过哈希表存储的，通过一个键的哈希值找到值的指针，只需要O(1)的时间复杂度

键是字符串，值有多种类型，值也选择了优化的数据结构

<img src="pic/kv.jpg" width=700 />

<img src="pic/O.jpg" width=400 />

2.2 hash

```python
哈希表的冲突问题：哈希冲突链（多加next.key()指针）

哈希冲突链过长可以使用rehash
rehash ：
1. 给哈希表 2 分配更大的空间，例如是当前哈希表 1 大小的两倍
2. 把哈希表 1 中的数据重新映射并拷贝到哈希表 2 中
   # 渐进式 rehash：每次处理请求，按哈希表顺序带部分数据到新表，将一次性大量拷贝分摊到了多次处理请求中，避免了耗时操作，保证了数据的快速访问
3. 释放哈希表 1 的空间
```

2.3 跳表: 单向链表基础上加了多级索引
<img src="pic/sorted_set.jpg" width=700 />

##### 三. IO多路复用

redis对外宣称是单线程的，避开了多线程并发控制的烦恼，利用io多路复用机制epoll解决了io操作的瓶颈问题
<img src="pic/epoll.jpg" width=700 />

